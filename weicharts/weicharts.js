(function(e,t){function n(e,t){for(var n in t)e[n]=t[n]}function r(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}function i(e){var t=null,n=s(e);if(n&&n.nodeName=="OBJECT")if(typeof n.SetVariable!=b)t=n;else{var r=n.getElementsByTagName(w)[0];r&&(t=r)}return t}function s(e){var t=null;try{t=p.getElementById(e)}catch(n){}return t}function o(e,t){var n=document.createElementNS(g,e);return t&&u(n,t),n}function u(e,t){for(var n in t)e.setAttribute(n,t[n])}var a={},f=function(){function e(){}return function(t,n){var r,i,s=t.prototype;e.prototype=n.prototype,i=t.prototype=new e;for(r in s)i[r]=s[r];return t.prototype.constructor=t,t.superClass=n.prototype,t}}(),l=document.getElementsByTagName("script"),c=l[l.length-1].getAttribute("src"),h=c.slice(0,c.lastIndexOf("/")+1),p=document,d=e,v=navigator,m=!/svg/.test(location.href),g="http://www.w3.org/2000/svg",y=!!p.createElementNS&&!!p.createElementNS(g,"svg").createSVGRect,b="undefined",w="object",E="Shockwave Flash",S="ShockwaveFlash.ShockwaveFlash",x="application/x-shockwave-flash",T=function(){var e=typeof p.getElementById!=b&&typeof p.getElementsByTagName!=b&&typeof p.createElement!=b,t=v.userAgent.toLowerCase(),n=v.platform.toLowerCase(),r=n?/win/.test(n):/win/.test(t),i=n?/mac/.test(n):/mac/.test(t),s=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,o=!1,u=[0,0,0],a=null;if(typeof v.plugins!=b&&typeof v.plugins[E]==w)a=v.plugins[E].description,a&&(typeof v.mimeTypes==b||!v.mimeTypes[x]||!!v.mimeTypes[x].enabledPlugin)&&(plugin=!0,o=!1,a=a.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),u[0]=parseInt(a.replace(/^(.*)\..*$/,"$1"),10),u[1]=parseInt(a.replace(/^.*\.(.*)\s.*$/,"$1"),10),u[2]=/[a-zA-Z]/.test(a)?parseInt(a.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof d.ActiveXObject!=b)try{var f=new ActiveXObject(S);f&&(a=f.GetVariable("$version"),a&&(o=!0,a=a.split(" ")[1].split(","),u=[parseInt(a[0],10),parseInt(a[1],10),parseInt(a[2],10)]))}catch(l){}return{w3:e,pv:u,wk:s,ie:o,win:r,mac:i}}();/8088/.test(h)&&(h="");var N=n,C=function(e,t){this.x=e==null?0:e,this.y=t==null?0:t};n(C.prototype,{clone:function(){return new C(this.x,this.y)}});var k=function(e,t,n,r){this.left=e==null?0:e,this.top=t==null?0:t,this.right=n==null?0:n,this.bottom=r==null?0:r};n(k.prototype,{check:function(){this.right<this.left&&(this.right=this.left),this.bottom<this.top&&(this.bottom=this.top)},getWidth:function(){return this.right-this.left},getHeight:function(){return this.bottom-this.top},clone:function(){return new k(this.left,this.top,this.right,this.bottom)}});var L={createHueColors:function(e){var t=[],n=360/e;for(var r=0;r<e;r++)t.push(L.toString(L.fromHSB(r*n,70,90)));return t},fromString:function(e){if(!e)return 0;var t=e.match(/[0-9a-fA-F]{6}/g);return t.length?parseInt(t[0],16):0},fromRGB:function(e,t,n){return e<<16|t<<8|n},fromHSB:function(e,t,n){var r,i,s,o,u,a,f,l,c,h,p;return r=e/360,i=t/100,s=n/100,t==0?(o=s*255,u=s*255,a=s*255):(f=r*6,f==6&&(f=0),l=f,c=s*(1-i),h=s*(1-i*(f-l)),p=s*(1-i*(1-(f-l))),l==0?(o=s,u=p,a=c):l==1?(o=h,u=s,a=c):l==2?(o=c,u=s,a=p):l==3?(o=c,u=h,a=s):l==4?(o=p,u=c,a=s):(o=s,u=c,a=h)),o*255<<16|u*255<<8|a*255},brightness:function(e,t){e=L.fromString(e);var n=Math.max(Math.min((e>>16&255)+t,255),0),r=Math.max(Math.min((e>>8&255)+t,255),0),i=Math.max(Math.min((e&255)+t,255),0);return L.toString(L.fromRGB(n,r,i))},toString:function(e){var e=e.toString(16);while(e.length<6)e="0"+e;return"#"+e}},A={roundToPrecision:function(e,t){var n=Math.pow(10,t||0);return Math.round(n*e)/n}},O=function(){this._node=this._newNode()};n(O.prototype,{_newNode:function(){return null},parent:function(){return this._node.parent()},getStyle:function(e){return this._node.style.getPropertyPriority(e)},setStyle:function(e,t){this._node.style.setProperty(e,t)},addEventListener:function(e,t,n){this._node.addEventListener(e,t,n)},removeEventListener:function(e,t,n){this._node.removeEventListener(e,t,n)},dispatchEvent:function(e){this._node.dispatchEvent(e)}});var M=f(function(){O.call(this),this._x=0,this._y=0,this._rotate=0},O);n(M.prototype,{attr:function(e){for(var t in e)this._node.setAttribute(t,e[t]);return this},move:function(e,t){return this._x=e,this._y=t,this._transform(),this},rotate:function(e){return this._rotate=e,this._transform(),this},getRect:function(){return this._node.getBoundingClientRect()},_transform:function(){var e="";if(this._x!==0||this._y!==0)e+="translate("+this._x+", "+this._y+")";this._rotate!=0&&(e+=" rotate("+this._rotate+")"),this._node.setAttribute("transform",e)}});var _=f(function(){M.call(this),this._drawStroke=!1,this.lineWidth=1,this.lineColor="#333333",this.lineAlpha=1,this._drawFill=!1,this.fillColor="#ffeeff",this.fillAlpha=1},M);n(_.prototype,{beginStroke:function(e,t,n){this._drawStroke=!0,this.lineWidth=e||this.lineWidth,this.lineColor=t||this.lineColor,this.lineAlpha=n||this.lineAlpha},endStroke:function(){this._drawStroke=!1},beginFill:function(e,t){return this._drawFill=!0,this.fillColor=e||this.fillColor,this.fillAlpha=t||this.fillAlpha,this},endFill:function(){this._drawFill=!1},draw:function(e){var t={stroke:this._drawStroke?this.lineColor:"none","stroke-width":this.lineWidth,"stroke-opacity":this.lineAlpha,fill:this._drawFill?this.fillColor:"none","fill-opacity":this.fillAlpha};N(t,e),this.attr(t)}});var D=f(function(e,t,n,r,i){_.call(this);var s={x:e||0,y:t||0,width:n||0,height:r||0,r:i||0};this._node=o("rect",s),this.draw()},_),P=f(function(e,t,n){_.call(this);var r={cx:e||0,cy:t||0,r:n||0};this._node=o("circle",r),this.draw()},_),H=f(function(e){_.call(this);var t={d:e||"M0 0"};this._node=o("path",t),this.draw()},_),B=f(function(){M.call(this)},M);n(B.prototype,{_newNode:function(){return o("g")},addChild:function(e){return this._node.appendChild(e._node),e},removeChild:function(e){this._node.removeChild(e._node)},clear:function(){while(this._node.lastChild)this._node.removeChild(this._node.lastChild)}});var j=f(function(e){M.call(this),this._textNode=document.createTextNode(e||""),this._tspan=o("tspan"),this._tspan.appendChild(this._textNode),this._node=o("text"),this._node.appendChild(this._tspan);var t={"font-family":"Verdana, Console, Arial, 微软雅黑, 宋体","font-size":12,fill:"#666666","text-anchor":"start"};this.attr(t)},M);n(j.prototype,{text:function(e){this._textNode.nodeValue=e},attr:function(e){var t=e["font-size"]||12;e["font-size"]=e.y=t,M.prototype.attr.call(this,e)}});var F=function(e,t){this._parent=e,this._SpriteClass=t,this._intelList=[],this._currentIndex=-1};n(F.prototype,{getLength:function(){return this._intelList.length},setLength:function(e){while(this._intelList.length>e)this._pop()},getChildAt:function(e){return this._intelList[e]},getChildIndex:function(e){return this._intelList.indexOf(e)},begin:function(e){this._SpriteClass=e||this._SpriteClass,this._currentIndex=0},next:function(){return this.getChildAt(this._currentIndex++)||this._push()},end:function(){this.setLength(this._currentIndex)},_push:function(){var e=new this._SpriteClass;return this._parent.addChild(e),this._intelList.push(e),e},_pop:function(){var e=this._intelList.pop();return e!=null&&this._parent.contains(e)&&this._parent.removeChild(e),e}});var I={title:{text:"weicharts",font:"微软雅黑, 黑体, Arial, Verdana",size:20,color:"#333333",offset:12},graph:{name:"某数据",lineThickness:2,lineAlpha:1,lineColor:null,fillColor:null,fillAlpha:.8},pieGraph:{type:"slice",radius:100,innerRadius:20},serialGraph:{useDifferentColor:!1,valueKey:"value",maxBarWidth:30},xyGraph:{xKey:"x",yKey:"y"},axis:{offset:0,axisThickness:1,axisColor:"",gridThickness:1,gridColor:"#333333",gridType:"line",titleText:"",titleOffset:0,labelColor:"#333333",labelFont:"微软雅黑, 黑体, Arial, Verdana",labelSize:12,labelInside:!1,labelFormatter:function(e){return e},labelPosition:"middle",labelOffset:3,labelRotation:0,opposite:!1},categoryAxis:{},valueAxis:{valueKeys:"auto",minValue:NaN,maxValue:NaN,autoGridCount:!0,gridCount:5,onlyInteger:!1,unit:"",unitPosition:"right"},plot:{backgroundColor:"#ffffff",backgroundAlpha:1,borderThickness:1,borderColor:1,borderAlpha:1},legend:{margin:10,offset:10,lineAlpha:1,lineThickness:1,lineColor:"#333333",lineAlpha:1},tooltip:{type:"",text:"",font:"",color:"#666666",backgroundAlpha:1,backgroundColor:"#ffffff",lineColor:"#333333",lineAlpha:.5},chart:{backgroundColor:"#ffffff",backgroundAlpha:1},pie:{labelKey:"label",valueKey:"value"},coordinate:{graphs:[],valueAxes:[]},rectangular:{autoMargins:!0,marginTop:0,marginBottom:0,marginLeft:0,marginRight:0},serial:{reverse:!1,categoryKey:"category",autoCategoryCount:!0,minCategoryCount:3,useDifferentColor:!1},newValueAxis:function(){var e={};return N(e,I.axis),N(e,I.valueAxis),e},newSerialGraph:function(){var e={};return N(e,I.graph),N(e,I.serialGraph),e},newPieConfig:function(){var e={};return N(e,I.chart),N(e,I.pie),e.title={},N(e.title,I.title),e.graph={},N(e.graph,I.graph),N(e.graph,I.pieGraph),e},newSerialConfig:function(){var e={};N(e,I.chart),N(e,I.coordinate),N(e,I.rectangular),N(e,I.serial),e.title={},N(e.title,I.title);var t={};return N(t,I.axis),N(t,I.categoryAxis),e.categoryAxis=t,e.graphs[0]=I.newSerialGraph(),e.graphs[0].type="line",e.valueAxes[0]=I.newValueAxis(),e.plot={},N(e.plot,I.plot),e.legend={},N(e.legend,I.legend),e}},q=function(e){this.config=e,this.axisData=null};n(q.prototype,{getPosition:function(e){return(this.maximum-e)/(this.maximum-this.minimum)},parseData:function(e,t,n,r){this.__searchMinAndMax(e,t,n||0,r||Number.MAX_VALUE),isNaN(this.config.minValue)||(this.minimum=Math.min(this.minimum,this.config.minValue)),this.__checkMinAndMax();var i=this.maximum-this.minimum,s=this.config.gridCount,o=i/s;this.__calculateUnit(o),this.__adjustMin(),this.__adjustMax(),this.axisData=this.__calculateAxisData(!0)},__searchMinAndMax:function(e,t,n,r){var i,s;r=Math.min(e.length,r);for(var o=n;o<r;o++){var u=e[o];for(var a in t){var f=u[t[a]];if(isNaN(f))continue;i=isNaN(i)?f:Math.min(f,i),s=isNaN(s)?f:Math.max(f,s)}}this.minimum=this.dataMininum=i,this.maximum=this.dataMaxinum=s},__calculateUnit:function(e){var t=Math.ceil(Math.log(e)*Math.LOG10E);if(this.config.onlyInteger||t==0)e=Math.pow(10,t);else{var n=Math.ceil(e/Math.pow(10,t-1));e=n*Math.pow(10,t-1)}this.majorUnit=A.roundToPrecision(e,10)},__checkMinAndMax:function(){if(this.minimum>this.maximum){var e=this.minimum;this.minimum=this.maximum,this.maximum=e}else this.minimum==this.maximum&&(this.maximum=this.maximum+1)},__adjustMin:function(){if(this.minimum!=0){var e=this.dataMininum;this.minimum=Math.floor(this.dataMininum/this.majorUnit)*this.majorUnit,e==this.minimum&&(this.minimum-=this.majorUnit)}this.minimum=A.roundToPrecision(this.minimum,10)},__adjustMax:function(){if(this.maximum!=0){var e=this.dataMaxinum;this.maximum=Math.ceil(this.dataMaxinum/this.majorUnit)*this.majorUnit,e==this.maximum&&(this.maximum+=this.majorUnit)}this.maximum=A.roundToPrecision(this.maximum,10)},__calculateAxisData:function(e){var t=this.majorUnit;if(t==0)return[];var n=this.minimum;if(e){var r=this.config.autoGridCount?1:this.config.gridCount;for(var i=0;n<this.maximum||i<r;i++)n=A.roundToPrecision(n+t,10);this.maximum=n}n=this.minimum;var s=[n];while(n<this.maximum)n=A.roundToPrecision(n+t,10),s.push(n);return s}});var R=f(function(){B.call(this),this.title,this.direction=null,this.blockWidth=NaN,this.frontSpace=0,this.backSpace=0},B);n(R.prototype,{_transformLabel_:function(e,t){var n=e.getRect(),r=this.config;this.direction=="x"?(r.labelInside,e.move(t-n.width/2,r.labelOffset)):this.direction=="y"&&(r.labelInside&&(t+=r.labelOffset),e.move(-(r.labelOffset+n.width),t-n.height/2))}});var U=f(function(e){this.gridCount=5,this.chart=e,R.call(this),this.labelContainer=new B,this.addChild(this.labelContainer),this.labelsPool=new F(this.labelContainer,j)},R);n(U.prototype,{getPosition:function(e){var t=this.data,n=t.min,r=t.max,i=(r-e)/(r-n);return i*this.axisLength},refresh:function(){var e=this.config,t=this.data,n=t.dataArr;this.labelsPool.begin();var r=n.length;for(var i=0;i<r;i++){var s=n[i],o=s.toString(),u=this.labelsPool.next();u.attr({font:e.labelFont,"font-color":e.labelColor}),this.labelFormatter!=null?u.text=this.labelFormatter(o):this.labelText?u.text(StringUtil.replaceValue(this.labelText,o)):u.text(o),this._transformLabel_(u,this.getPosition(s))}this.labelsPool.end()}});var z=f(function(e){this.chart=e,this.touchSide=!1,this.axisLength=0,this.labelsPool=new F(this),R.call(this)},R);n(z.prototype,{getPosition:function(e){if(this.chart._dataSource==null)return NaN;var t=this.touchSide?this.chart._categoryCount-1:this.chart._categoryCount,n=this.axisLength*(e/t);return n},getIndex:function(e,t){if(e>0&&t>0&&e<this.chart.plotArea.width&&t<this.chart.plotArea.height){var n=e/this.blockWidth;return this.touchSide?Math.round(n):Math.floor(n)}return-1},refresh:function(){this.touchSide&&this.chart._categoryCount>1?this.blockWidth=this.axisLength/(this.chart._categoryCount-1):this.blockWidth=this.axisLength/this.chart._categoryCount,_maxLength=NaN,_labels=[],this.labelsPool.begin(j);var e=this.chart._dataSource,t=this.chart._chartConfig,n=this.config,r=-45,i=r*Math.PI/180;for(var s=0;s<e.length;s++){var o=this.labelsPool.next(),u=e[s][t.categoryKey];o.text(u),o.attr({font:"Arial","font-size":n.labelSize,"font-color":n.labelColor});var a=this.getPosition(s);this.touchSide==0&&(a+=this.blockWidth/2),this._transformLabel_(o,a)}this.labelsPool.end()}});var W=f(function(){B.call(this)},B);n(W.prototype,{});var X=f(function(e){W.call(this),this.chart=e,this.pool=new F(this)},W);n(X.prototype,{refresh:function(){var e=this.chart._chartConfig,t=this.config,n=this.chart._chartData.graphArr,r=this.chart._chartData.graphTotalNum,i=this.chart._dataSource.length,s=i>1?-Math.PI/2:-Math.PI,o=s;this.pool.begin(Q);for(var u=0;u<i;u++){var a=this.pool.length==u,f=this.pool.next();f.index=u,f.color=e.colors[u%e.colors.length],f.borderThicknesss=1,f.borderColor="#666666";var l=Math.PI*2*(n[u]/r),c=o+l;c=Math.max(c,o),c=Math.min(c,s+Math.PI*2);var h=(c+o)/2;if(a||!0)f.radius=t.radius,f.radiusIn=Math.min(t.radius,t.innerRadius),f.startAngle=o,f.endAngle=c;f.render(),o=c}this.pool.end()}});var V=f(function(e,t){B.call(this),this.chart=e,this.graphIndex=0,this.graphCount=1,this.valueAxis=t,this.pool=new F(this)},B);n(V.prototype,{refresh:function(){var e=this.chart._chartConfig,t=this.config,n=this.chart._dataSource,r=this.chart.categoryAxis.blockWidth,i=this.chart._categoryCount,s=r*.7/this.graphCount;s=Math.min(s,t.maxBarWidth);if(this.graphCount==1)var o=0;else o=s*.2;var u=r-s*this.graphCount-o*(this.graphCount-1),a=u/2+this.graphIndex*(s+o);this.pool.begin(G);for(var f=0;f<i;f++){var l=this.pool.length==f,c=this.pool.next();c.graph=this,c.index=f,c.label=n[f][t.valueKey];if(t.useDifferentColor)var h=e.colors[f%e.colors.length];else h=t.fillColor;c.config={lineAlpha:t.lineAlpha,lineThickness:t.lineThickness,lineColor:t.lineColor,fillAlpha:t.fillAlpha,fillColor:h};var p=this.chart.categoryAxis.getPosition(f)+a,d=this.valueAxis.getPosition(n[f][t.valueKey]),v=s,m=this.valueAxis.getPosition(0)-d;p=Math.round(p)+.5,d=Math.round(d)+.5,v=Math.round(v),m=Math.round(m);if(l||!0)c.move(p,d),c.width=v,c.height=m;c.render()}this.pool.end()}});var $=f(function(e,t){W.call(this),this.chart=e,this.valueAxis=t,this.lineShape=this.addChild(new H),this.dotContainer=this.addChild(new B),this.pool=new F(this.dotContainer)},W);n($.prototype,{refresh:function(){var e=this.config,t=this.chart._categoryCount,n=this.chart.categoryAxis.touchSide?0:this.chart.categoryAxis.blockWidth/2;this.pool.begin(Y);for(var r=0;r<t;r++){var i=this.pool.length==r,s=this.pool.next();s.graph=this,s.index=r,s.label=this.chart._dataSource[r][e.valueKey],s.config={lineAlpha:e.lineAlpha,lineThickness:e.lineThickness,lineColor:e.lineColor||e.fillColor,fillAlpha:1,fillColor:16777215};var o=this.chart.categoryAxis.getPosition(r)+n,u=this.valueAxis.getPosition(this.chart._dataSource[r][e.valueKey]);(i||!0)&&s.move(o,u),s.render()}this.pool.end(),this.__refreshLines()},__refreshLines:function(){var e=this.config;this.lineShape.beginStroke(e.lineThickness,e.lineColor||e.fillColor),this.pool.begin();var t=this.pool.getChildAt(0);if(t)var n="M"+t._x+","+t._y;for(var r=0;r<this.pool.getLength();r++){var i=this.pool.next();n+="L"+i._x+","+i._y}this.lineShape.attr({d:n}),this.lineShape.draw()}});var J=f(function(e){this.chart=e,B.call(this)},B);n(J.prototype,{refresh:function(){var e=this.chart.plotArea,t,n,r,i;t=Math.round(e.left)+.5,n=Math.round(e.top)+.5,r=Math.round(e.right-e.left),i=Math.round(e.bottom-e.top);var s=this.config;this.bg==null&&(this.bg=new D,this.addChild(this.bg)),this.bg.beginStroke(s.borderThicknesss,s.borderColor,s.borderAlpha),this.bg.beginFill(s.backgroundColor,s.backgroundAlpha),this.bg.attr({x:t,y:n,width:r,height:i}).draw()}});var K=f(function(e){B.call(this),this.chart=e,this.pool=new F(this)},B);n(K.prototype,{refresh:function(){var e=this.chart._chartConfig,t=e.colors,n=this.config,r=this.chart._chartData.legendArr,i=0,s=0;this.pool.begin(Z);for(var o=0;o<r.length;o++){var u=this.pool.next();u.text=r[o].name,u.config={fillColor:t[o%t.length],fillAlpha:n.fillAlpha,lineThickness:n.lineThickness,lineColor:n.lineColor,lineAlpha:n.lineAlpha},u.render();var a=u.getRect();i+a.width>this.chart.stageWidth?(i=0,s+=a.height+5,u.move(Math.round(i)+.5,Math.round(s)+.5)):(u.move(Math.round(i)+.5,Math.round(s)+.5),i+=a.width+n.margin)}this.pool.end()}});var Q=f(function(){B.call(this),this._shape=this.addChild(new H),this.borderAlpha=.8,this.startAngle=0,this.endAngle=0,this.radiusIn=30,this.radius=120},B);n(Q.prototype,{render:function(){this._calculateSector()},_calculateSector:function(){var e=this.borderThicknesss,t=Math.asin(e/this.radius),n=this.startAngle+t,r=this.endAngle-t;t=Math.asin(e/this.radiusIn);var i=this.startAngle+t,s=this.endAngle-t;this._shape.beginStroke(this.borderThicknesss,this.borderColor,this.borderAlpha),this._shape.beginFill(this.color,this.alpha),this._drawSector(this._shape,n,r,i,s,this.radius,this.radiusIn)},_drawSector:function(e,t,n,r,i,s,o){var u=this.endAngle-this.startAngle>Math.PI?1:0,a=Math.cos(this.startAngle)*s,f=Math.sin(this.startAngle)*s,l=Math.cos(this.endAngle)*s,c=Math.sin(this.endAngle)*s,h="M"+a+","+f;h+=" A"+s+","+s+" 0 "+u+" 1 "+l+","+c,a=Math.cos(this.startAngle)*o,f=Math.sin(this.startAngle)*o,l=Math.cos(this.endAngle)*o,c=Math.sin(this.endAngle)*o,h+=" L"+l+","+c,h+=" A"+o+","+o+" 0 "+u+" 0 "+a+","+f,h+=" Z",e.draw({d:h})}});var G=f(function(){function e(e){t.onOver=e.type=="mouseover",t.render()}B.call(this),this.width,this.height,this.onOver=!1,this._shape=new D,this.addChild(this._shape),this.addEventListener("mouseover",e),this.addEventListener("mouseout",e);var t=this},B);n(G.prototype,{render:function(){var e=this.config;this._shape.beginStroke(1,e.lineColor,e.lineAlpha),this._shape.beginFill(this.onOver?L.brightness(e.fillColor,20):e.fillColor,e.fillAlpha),this._shape.attr({width:this.width,height:this.height}),this._shape.draw()}});var Y=f(function(){B.call(this),this._shape=null,this.radius=3,this.onOver=!1},B);n(Y.prototype,{render:function(){this._shape||(this._shape=new P,this.addChild(this._shape));var e=this.config;this._shape.beginStroke(e.lineThickness,e.lineColor,e.lineAlpha),this._shape.beginFill("#ffffff"),this._shape.attr({r:this.radius}),this._shape.draw()}});var Z=f(function(){B.call(this),this._shape=this.addChild(new D),this._labelObject=this.addChild(new j),this.onOver=!1},B);n(Z.prototype,{render:function(){var e=this.config;this._shape.beginStroke(e.lineThickness,e.lineColor,e.lineAlpha),this._shape.beginFill(e.fillColor,e.fillAlpha),this._shape.draw({x:0,y:2,width:11,height:11}),this._labelObject.text(this.text);var t,n,r;t=this.getRect(),n=this._labelObject.getRect(),r=(t.height-n.height)/2,this._labelObject.move(16,r)}});var et=f(function(){this.title,this.lengend,this.tooltip,B.call(this),this.__init__()},B);n(et.prototype,{_newNode:function(){return o("svg")},__init__:function(){},setSize:function(e,t){this.attr({width:e,height:t})},setDataSource:function(e){this._dataSource=e},setConfig:function(e){this._chartConfig=e},setData:function(e){this._chartData=e},update:function(){this.stageWidth=this._node.clientWidth,this.stageHeight=this._node.clientHeight,this._configChart(),this._refreshChart()},_configChart:function(){var e=this._chartConfig,t;e.title==null?this.titleObject&&(this.removeChild(this.titleObject),this.titleObject=null):e.title&&(this.titleObject||(this.titleObject=new j,this.addChild(this.titleObject)),t=e.title,this.titleObject.text(t.text),this.titleObject.attr({"font-family":t.font,"font-size":t.size,"text-anchor":"middle",fill:t.color})),e.legend==null?this.legend&&(this.removeChild(this.legend),this.legend=null):e.legend&&(this.legend||(this.legend=new K(this),this.addChild(this.legend)),this.legend.config=e.legend)},_refreshChart:function(){this.graphArea=new k(0,0,this.stageWidth,this.stageHeight);var e=this._chartConfig,t;this.titleObject&&(t=e.title,this.titleObject.move(this.stageWidth/2,0),this.graphArea.top=this.titleObject.getRect().height+t.offset);if(this.legend){t=this.legend.config,this.legend.refresh();var n=this.legend.getRect();this.graphArea.bottom-=n.height+t.offset;var r,i;r=(this.stageWidth-n.width)/2,i=this.graphArea.bottom+t.offset,r=Math.round(r),i=Math.round(i),this.legend.move(r,i)}}});var tt=f(function(){et.call(this),this.plot,this.graphs},et);n(tt.prototype,{__init__:function(){et.prototype.__init__.call(this),this.plot=this._newPlot(),this.addChild(this.plot),this.graphContainer=new B,this.addChild(this.graphContainer),this.axisContainer=new B,this.axisContainer.mouseChildren=this.axisContainer.mouseEnabled=!1,this.addChild(this.axisContainer),this.tooltipContainer=new B,this.tooltipContainer.mouseChildren=this.tooltipContainer.mouseEnabled=!1,this.addChild(this.tooltipContainer)},_newPlot:function(){return null},_configChart:function(){et.prototype._configChart.call(this);var e=this._chartConfig;this.plot.config=e.plot}});var nt=f(function(){this.autoMargins=!0,this._top=0,this._bottom=0,this._left=0,this._right=0,tt.call(this)},tt);n(nt.prototype,{_newPlot:function(){return new J(this)},_adjustPlotArea:function(e,t,n){var r=this._chartConfig,i=0,s=0,o=0;for(var u=0;u<e.length;u++){var a=e[u];a.axisLength=this.plotArea.bottom-this.plotArea.top,a.move(this.plotArea.left,this.plotArea.top),a.refresh(),i=Math.max(i,a.backSpace,0),s=Math.max(s,a.frontSpace,0),a.config.labelInside==0&&(o+=a.config.offset+a.getRect().width)}var f=0;for(u=0;u<t.length;u++)a=t[u],a.axisLength=this.plotArea.bottom-this.plotArea.top,a.move(this.plotArea.right,this.plotArea.top),a.refresh(),i=Math.max(i,a.backSpace,0),s=Math.max(s,a.frontSpace,0),a.config.labelInside==0&&(f+=a.config.offset+a.getRect().width);var l=0,c=0,h=0,p=0;for(u=0;u<n.length;u++)a=n[u],a.axisLength=this.plotArea.right-this.plotArea.left,a.move(this.plotArea.left,this.plotArea.bottom),a.refresh(),l=Math.max(l,a.frontSpace,0),c=Math.max(c,a.backSpace,0),a.config.labelInside==0&&(p+=a.config.offset+a.getRect().height);this._top=Math.max(h,i),this._bottom=Math.max(p,s),this._left=Math.max(o,l),this._right=Math.max(f,c);var d=!1;this.plotArea.top<this._top&&(this.plotArea.top=this._top,d=!0),this.plotArea.left<this.graphArea.left+this._left&&(this.plotArea.left=this.graphArea.left+this._left,d=!0),this.plotArea.right>this.graphArea.right-this._right&&(this.plotArea.right=Math.max(this.graphArea.right-this._right,this.plotArea.left),d=!0),this.plotArea.bottom>this.graphArea.bottom-this._bottom&&(this.plotArea.bottom=Math.max(this.graphArea.bottom-this._bottom,this.plotArea.top),d=!0),r.autoMargins&&d&&this._adjustPlotArea(e,t,n)},_adjustGraphArea:function(){this.graphArea.right=this.plotArea.right+this._right,this.graphArea.bottom=this.plotArea.bottom+this._bottom}});var rt=f(function(){et.call(this),this.graph=null,this._legendData=null},et);n(rt.prototype,{__init__:function(){et.prototype.__init__.call(this)},_configChart:function(){et.prototype._configChart.call(this);var e=this._chartConfig;e.colors&&e.colors.length>0||(e.colors=L.createHueColors(this._dataSource.length)),this.graph||(this.graph=new X(this),this.addChild(this.graph)),this.graph.config=e.graph},_refreshChart:function(){et.prototype._refreshChart.call(this),this.graphArea.bottom-=1,this.graph.move(this.stageWidth/2,(this.graphArea.bottom+this.graphArea.top)/2),this.graph.refresh()}});var it=f(function(){nt.call(this),this._startIndex,this._endIndex,this._categoryCount=3,this.categoryAxis=null,this.areaGraphs=[],this.barGraphs=[],this.lineGraphs=[]},nt);n(it.prototype,{_configChart:function(){nt.prototype._configChart.call(this);var e=this._chartConfig,t=this._dataSource,n=this._chartData;this.categoryAxis||(this.categoryAxis=new z(this),this.addChild(this.categoryAxis)),this.categoryAxis._categoryCount=t.length,this.categoryAxis.config=e.categoryAxis,this.valueAxis||(this.valueAxis=new U(this),this.addChild(this.valueAxis)),this.valueAxis.config=e.valueAxes[0],this.valueAxis.data=n.valueAxes[0];var r=this.categoryAxis,i=e.categoryKey;this.graphContainer.clear(),this.graphs=[];var s=[],o=[];for(var u=0;u<e.graphs.length;u++){var a;switch(e.graphs[u].type){case"column":case"bar":a=this.barGraphs.shift()||new V(this,this.valueAxis),s.push(a);break;case"line":a=this.lineGraphs.shift()||new $(this,this.valueAxis),o.push(a);break;default:continue}a.config=e.graphs[u],this.graphs.push(a)}this.barGraphs=s,this.lineGraphs=o;for(u=0;u<this.barGraphs.length;u++){var f=this.barGraphs[u];f.graphCount=this.barGraphs.length,f.graphIndex=u,this.graphContainer.addChild(f)}for(u=0;u<this.lineGraphs.length;u++)a=this.lineGraphs[u],this.graphContainer.addChild(a);for(u=0;u<this.graphs.length;u++)a=this.graphs[u],a.config.fillColor=a.config.fillColor||e.colors[u%this.graphs.length]},_refreshChart:function(){nt.prototype._refreshChart.call(this);var e=this._chartConfig;if(!e.inverted)var t=this.categoryAxis,n=this.valueAxis;else t=this.categoryAxis,n=this.valueAxis;t.direction="x",n.direction="y",this.plotArea=this.graphArea.clone(),this.plotArea.bottom-=1,this.plotArea.right-=1,this._adjustPlotArea([n],[],[t]),this._adjustGraphArea(),this.plot.refresh();var r,i;r=Math.round(this.plotArea.left),i=Math.round(this.plotArea.top);for(var s=0;s<this.graphs.length;s++){var o=this.graphs[s];o.refresh(),o.move(r,i)}}});var st=function(t){function n(){var e=s(t.element);e&&e.parentNode.replaceChild(i._node,e),e=null}this.id=t.element,this.type=t.type;var i=this,o=this._readyCallbackKey="weicharts_"+(new Date).getTime();e[o]=function(e){i._readyCallback(e)},this._node=this._newChart(this.type).firstChild,p.body?n():r(d,"load",n)};n(st.prototype,{_newChart:function(e){var t=p.createElement("div");if(t){var n="",r="",i="100%",s="100%";r+='<param name="allowScriptAccess" value="always" />',r+='<param name="wmode" value="Opaque" />',r+='<param name="flashvars" value="readyCallback='+this._readyCallbackKey+'" />',T.ie&&T.win?(n='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"',n+=' id="'+this.id+'"',n+=' width="'+i+'"',n+=' height="'+s+'"',n+=">",n+='<param name="movie" value="'+h+'weicharts.swf" />',n+=r,n+="</object>"):(n='<object type="application/x-shockwave-flash"',n+=' id="'+this.id+'"',n+=' name="'+this.id+'"',n+=' width="'+i+'"',n+=' height="'+s+'"',n+=' data="'+h+'weicharts.swf"',n+=">",n+=r,n+="</object>"),t.innerHTML=n}return t},_readyCallback:function(e){this.flash=i(e);if(!this.flash)return;this.flash.createChart(this.type),this._dataSource&&(this.flash.setDataSource(this._dataSource),this._dataSource=null),this._chartConfig&&(this.flash.setConfig(this._chartConfig),this._chartConfig=null),this._chartData&&(this.flash.setData(this._chartData),this._chartData=null),this._refreshed&&(this.flash.update(),this._refreshed=!1)},setSize:function(e,t){this.width=e,this.height=t,this._node},setDataSource:function(e){this.flash?this.flash.setDataSource(this._dataSource):this._dataSource=e},setConfig:function(e){this.flash?this.flash.setConfig(this._chartConfig):this._chartConfig=e},setData:function(e){this.flash?this.flash.setData(this._chartData):this._chartData=e},update:function(){this.flash?this.flash.refresh():this._refreshed=!0}});var ot=function(e){function t(){var t=s(e.element);t&&t.parentNode.replaceChild(n._node,t),t=null,n.initialized=!0,n._readyCallback()}this._chartView=this._newChart(e.type),this._node=this._chartView._node;var n=this;p.body?t():r(d,"load",t)};n(ot.prototype,{_newChart:function(e){switch(e){case"pie":return new rt;case"serial":return new it}return null},_readyCallback:function(){this._dataSource&&(this._chartView.setDataSource(this._dataSource),this._dataSource=null),this._chartConfig&&(this._chartView.setConfig(this._chartConfig),this._chartConfig=null),this._chartData&&(this._chartView.setData(this._chartData),this._chartData=null),this._refreshed&&(this._chartView.refresh(),this._refreshed=!1)},setSize:function(e,t){this._chartView.setSize(e,t)},setDataSource:function(e){this.initialized?this._chartView.setDataSource(e):this._dataSource=e},setConfig:function(e){this.initialized?this._chartView.setConfig(e):this._chartConfig=e},setData:function(e){this.initialized&&this._chartView.setData(e)},update:function(){this.initialized&&this._chartView.update()}});var ut=function(e){this.element=e,this._chartView=y&&!m?new ot(this):new st(this)};n(ut.prototype,{setData:function(e){return this._dataSource=e,this.__render(),this},setConfig:function(e){for(var t in e)switch(t){case"title":case"graph":case"legend":case"categoryAxis":case"tooltip":case"plot":this._chartConfig[t]?N(this._chartConfig[t],e[t]):this._chartConfig[t]=e[t];break;case"valueAxes":for(var n=0;n<e[t].length;n++){var r=I.newValueAxis();N(r,e[t][n]),this._chartConfig[t][n]=r}while(this._chartConfig[t].length>n)this._chartConfig[t].pop();break;case"graphs":for(var n=0;n<e[t].length;n++)r=I.newSerialGraph(),N(r,e[t][n]),this._chartConfig[t][n]=r;while(this._chartConfig[t].length>n)this._chartConfig[t].pop();break;default:this._chartConfig[t]=e[t]}return this.__render(),this},setSize:function(e,t){return this._chartView.setSize(e,t),this.__render(),this},__render:function(){if(this.timerIndex==t){var e=this;this.timerIndex=setTimeout(function(){e.__onTimer()},33)}},__onTimer:function(){clearTimeout(this.timerIndex),this.timerIndex=t,this._parseConfig(),this._parseData(),this._chartView.setDataSource(this._dataSource),this._chartView.setConfig(this._chartConfig),this._chartView.update()},_parseConfig:function(){},_parseData:function(){}});var at=f(function(e){ut.call(this,e)},ut);n(at.prototype,{_parseData:function(){ut.prototype._parseData.call(this);var e=this._chartConfig,t=e.graphs;e.colors&&e.colors.length>0||(e.colors=L.createHueColors(e.graphs.length)),this._legendData=[];for(var n=0;n<t.length;n++)this._legendData.push({name:t[n].name,color:e.colors[n%e.colors.length]})}});var ft=f(function(e){at.call(this,e)},at);n(ft.prototype,{});var lt=f(function(e){this.type="pie",this._chartConfig=I.newPieConfig(),ut.call(this,e),this.graph=null},ut);n(lt.prototype,{_parseConfig:function(){ut.prototype._parseConfig.call(this);var e=this._chartConfig,t=this._dataSource;e.colors&&e.colors.length>0||(e.colors=L.createHueColors(t.length))},_parseData:function(){ut.prototype._parseData.call(this);var e=this._chartConfig,t=this._dataSource,n=0,r=[],i=0,s=[];for(var o in t){var u=t[o][e.valueKey]=Number(t[o][e.valueKey]);n+=u}if(n>0)for(o in t){var u=t[o][e.valueKey],a=u/n,f;a>0&&a<.01?f=.01*n:f=u,i+=f,r.push(f)}for(o=0;o<t.length;o++)s.push({name:t[o][e.labelKey],color:e.colors[o%e.colors.length]});this._chartView.setData({graphArr:r,graphTotalNum:i,legendArr:s})}});var ct=f(function(e){this.type="serial",this._chartConfig=I.newSerialConfig(),ft.call(this,e)},ft);n(ct.prototype,{_parseConfig:function(){ft.prototype._parseConfig.call(this);var e=this._chartConfig;if(e.valueAxes.length==1){e.valueAxes[0].valueKeys=[];for(var t=0;t<e.graphs.length;t++)e.valueAxes[0].valueKeys[t]=e.graphs[t].valueKey}},_parseData:function(){ft.prototype._parseData.call(this);var e=this._chartConfig,t=this._dataSource;e.autoCategoryCount&&(this._categoryCount=t.length,this._categoryCount=Math.max(e.minCategoryCount,this._categoryCount));var n=[],r=new q(e.valueAxes[0]);r.parseData(t,e.valueAxes[0].valueKeys,0,Number.MAX_VALUE),n[0]=r,this._chartView.setData({valueAxes:[{dataArr:r.axisData,min:r.minimum,max:r.maximum}],legendArr:this._legendData})}}),a.PieChart=lt,a.SerialChart=ct,e.weicharts=a})(window)